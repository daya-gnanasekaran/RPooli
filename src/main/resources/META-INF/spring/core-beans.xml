<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:p="http://www.springframework.org/schema/p" xmlns:c="http://www.springframework.org/schema/c"
    xmlns:context="http://www.springframework.org/schema/context"
    xsi:schemaLocation="
        http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd">

    <bean name="disposable" abstract="true" destroy-method="dispose" />

    <bean name="environment" parent="disposable"
        class="eu.openanalytics.rpooli.RPooliAppEnvironment" />

    <bean name="context" class="eu.openanalytics.rpooli.RPooliContext"
        c:servletContext-ref="servletContext" depends-on="environment" />

    <bean name="server" parent="disposable" class="eu.openanalytics.rpooli.RPooliServer"
        c:servletContext-ref="servletContext" c:context-ref="context"
        factory-method="create" />

    <bean name="abstractRPooliServerAware" abstract="true" c:server-ref="server" />

    <bean name="clientSimulator" parent="abstractRPooliServerAware"
        class="eu.openanalytics.rpooli.ClientSimulator" />

    <bean name="nodesResource" parent="abstractRPooliServerAware"
        class="eu.openanalytics.rpooli.api.NodesResource"
        c:clientSimulator-ref="clientSimulator" />

    <bean name="poolResource" parent="abstractRPooliServerAware"
        class="eu.openanalytics.rpooli.api.PoolResource" />
</beans>
